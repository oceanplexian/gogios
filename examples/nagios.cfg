##############################################################################
#
# GOGIOS MAIN CONFIGURATION FILE
#
# This is the main config file for Gogios, a drop-in replacement for
# Nagios 4.1.1. The format is identical to nagios.cfg so if you've
# configured Nagios before, you already know what you're doing.
#
# Every directive is documented inline below. Uncomment and adjust
# as needed for your environment.
#
# Usage:
#   gogios -v examples/nagios.cfg          # validate config
#   gogios -v -v examples/nagios.cfg       # validate + list all objects
#   gogios examples/nagios.cfg             # run in foreground
#   gogios -d examples/nagios.cfg          # run as daemon
#
##############################################################################



##############################################################################
# FILE PATHS
##############################################################################

# Main log file. All alerts, notifications, external commands, and state
# changes get written here in standard Nagios log format.
log_file=var/gogios.log

# Archive directory for rotated log files.
log_archive_path=var/archives

# status.dat - Written periodically with the current state of all hosts
# and services. Thruk and other UIs read this. Update interval is
# controlled by status_update_interval below.
status_file=var/status.dat

# retention.dat - Saves runtime state (host/service states, downtime,
# comments, notification counters) across restarts. Gogios writes this
# on clean shutdown and reads it back on startup.
state_retention_file=var/retention.dat

# Object cache file. A compiled dump of all parsed object definitions.
# Written after config parsing. Mostly useful for debugging.
object_cache_file=var/objects.cache

# External command pipe (named FIFO). Scripts and UIs write commands
# here to schedule checks, acknowledge problems, set downtimes, etc.
# Format: [unix_timestamp] COMMAND_NAME;arg1;arg2;...
command_file=var/rw/gogios.cmd

# Lock file. Prevents multiple Gogios instances from running with
# the same config.
lock_file=var/gogios.lock

# Temp file and directory used during atomic writes.
temp_file=var/gogios.tmp
temp_path=var

# Debug file. Only written when debug_level > 0.
#debug_file=var/gogios.debug



##############################################################################
# RESOURCE FILES
##############################################################################

# Resource files define $USERn$ macros (1-256). These are not exposed
# to CGIs or UIs, making them safe for storing passwords and paths.
# You can specify multiple resource files.
resource_file=resource.cfg



##############################################################################
# OBJECT CONFIGURATION FILES
##############################################################################

# List every object config file individually with cfg_file, or point
# at a directory with cfg_dir and Gogios will load every .cfg file
# in it (non-recursive).
#
# cfg_dir=objects      # alternative: load everything in objects/

cfg_file=objects/commands.cfg
cfg_file=objects/timeperiods.cfg
cfg_file=objects/templates.cfg
cfg_file=objects/contacts.cfg
cfg_file=objects/hosts.cfg
cfg_file=objects/hostgroups.cfg
cfg_file=objects/services.cfg
cfg_file=objects/servicegroups.cfg
cfg_file=objects/dependencies.cfg
cfg_file=objects/escalations.cfg



##############################################################################
# LIVESTATUS API (Gogios extension)
##############################################################################

# Gogios has a built-in Livestatus server that speaks the LQL protocol.
# Thruk, check_mk, and custom scripts can query it for real-time state
# data without touching status.dat.
#
# TCP listener - accessible over the network.
# Set to 0.0.0.0:6557 to listen on all interfaces, or 127.0.0.1:6557
# for localhost only.
livestatus_tcp=127.0.0.1:6557

# Unix domain socket - traditional Livestatus socket.
# Thruk can connect to either TCP or Unix socket.
query_socket=var/rw/live

# Both can run simultaneously. Comment out whichever you don't need.



##############################################################################
# LOGGING
##############################################################################

# Send log output to syslog in addition to the log file.
# 0 = disabled, 1 = enabled
use_syslog=0

# Control what gets logged. Each of these is 0 or 1.
log_notifications=1
log_service_retries=1
log_host_retries=1
log_event_handlers=1
log_external_commands=1
log_passive_checks=1

# Log the initial state of all hosts and services at startup.
# Useful for seeing the full picture after a restart.
log_initial_states=1

# Log the current state of all hosts and services during log rotation.
log_current_states=1

# Log rotation method:
#   n = none (log grows forever, hope you have disk space)
#   h = hourly
#   d = daily
#   w = weekly
#   m = monthly
log_rotation_method=d

# Debug logging. Level is a bitmask. 0 = off.
# Verbosity: 0 = basic, 1 = more detail, 2 = full firehose
debug_level=0
debug_verbosity=0
#max_debug_file_size=1000000



##############################################################################
# SCHEDULING
##############################################################################

# Base interval length in seconds. A check_interval of 5 means
# 5 * interval_length seconds between checks. Default is 60.
interval_length=60

# How to calculate the inter-check delay (ICD) for initial scheduling.
# This spreads checks out so they don't all fire at once on startup.
#   n = no delay (don't do this)
#   d = use "dumb" 1-second delay
#   s = "smart" delay based on check_interval (recommended)
#   x.xx = fixed delay in seconds
service_inter_check_delay_method=s
host_inter_check_delay_method=s

# Service interleave factor. Controls how checks are distributed
# across hosts to avoid hammering one host with all its service
# checks at the same time.
#   s = smart (auto-calculated, recommended)
#   <number> = fixed interleave factor
service_interleave_factor=s

# Maximum number of minutes to spread initial checks over on startup.
# Lower = faster initial state, higher = gentler on your infrastructure.
max_service_check_spread=5
max_host_check_spread=5

# How often (in seconds) to check for completed check results.
check_result_reaper_frequency=10



##############################################################################
# CHECK EXECUTION
##############################################################################

# Timeouts in seconds. If a check plugin doesn't return within this
# time, it's killed and the check returns CRITICAL (or whatever
# service_check_timeout_state is set to).
service_check_timeout=30
host_check_timeout=15
event_handler_timeout=15
notification_timeout=15

# Maximum number of checks to run concurrently. Each check runs in
# its own goroutine, bounded by a semaphore. Set this based on your
# system's capacity and how many hosts you're monitoring.
# 0 = unlimited (brave, but not recommended)
max_concurrent_checks=64

# What state to assign when a service check times out.
# c = CRITICAL (default), w = WARNING, u = UNKNOWN, o = OK (why?)
#service_check_timeout_state=c



##############################################################################
# STATE RETENTION
##############################################################################

# Save and restore state across restarts. When enabled, Gogios writes
# retention.dat on shutdown and reads it back on startup, preserving
# host/service states, downtimes, comments, and notification counters.
# 0 = start fresh every time, 1 = remember everything
retain_state_information=1

# How often (in seconds) to auto-save retention data while running.
# Acts as a safety net if Gogios crashes or gets kill -9'd.
retention_update_interval=60

# Restore the global program state (notifications enabled, checks
# enabled, etc.) from the retention file. If you disabled notifications
# via external command, this remembers that across restarts.
use_retained_program_state=1

# How often (in seconds) to write status.dat. Lower values mean
# more responsive UIs, but more disk I/O. 5-10 is reasonable.
status_update_interval=5



##############################################################################
# FEATURE TOGGLES
##############################################################################

# Master switches for major features. All of these can also be toggled
# at runtime via external commands (ENABLE_NOTIFICATIONS, etc.)

# Active check execution. Turn these off and Gogios becomes a passive-only
# monitoring system.
execute_service_checks=1
execute_host_checks=1

# Passive check acceptance. Allows PROCESS_SERVICE_CHECK_RESULT and
# PROCESS_HOST_CHECK_RESULT commands.
accept_passive_service_checks=1
accept_passive_host_checks=1

# Notifications. The big red button. Turn this off and nobody gets paged,
# but checks keep running and state keeps updating.
enable_notifications=1

# Event handlers. Scripts that run automatically on state changes.
enable_event_handlers=1

# Flap detection. Identifies hosts/services that bounce between states
# too rapidly and suppresses notifications until they stabilize.
enable_flap_detection=1

# External command processing. If disabled, the command pipe is ignored.
check_external_commands=1

# Performance data processing. Passes perfdata to file or command handlers.
process_performance_data=1

# Freshness checking for passive checks. If a passive check hasn't
# reported in within its freshness_threshold, force an active check.
check_service_freshness=1
check_host_freshness=0

# Orphaned check detection. If a check was dispatched but never returned
# a result, reschedule it.
check_for_orphaned_services=1
check_for_orphaned_hosts=1

# Obsessive compulsive processing. Runs a command after every single
# check result. Useful for feeding results to a distributed setup.
#obsess_over_services=0
#obsess_over_hosts=0
#ocsp_command=obsess_over_svc
#ochp_command=obsess_over_host

# Aggressive host checking. Forces a host check whenever a service
# check returns a non-OK state. More accurate, but more host checks.
#use_aggressive_host_checking=0

# Soft state dependencies. Check dependencies against SOFT states too,
# not just HARD states. Usually you want this off.
#soft_state_dependencies=0



##############################################################################
# FRESHNESS CHECKING
##############################################################################

# How often (in seconds) to check for stale passive checks.
service_freshness_check_interval=60
#host_freshness_check_interval=60

# Extra seconds added to the freshness threshold to account for
# check latency and scheduling jitter.
additional_freshness_latency=15



##############################################################################
# FLAP DETECTION THRESHOLDS
##############################################################################

# Flap detection uses a 21-entry weighted circular buffer of state
# changes. When the percent change exceeds the high threshold, the
# object starts flapping and notifications are suppressed. When it
# drops below the low threshold, flapping stops.

low_service_flap_threshold=25.0
high_service_flap_threshold=50.0
low_host_flap_threshold=25.0
high_host_flap_threshold=50.0



##############################################################################
# GLOBAL EVENT HANDLERS
##############################################################################

# Commands to run on every host/service state change, in addition to
# any per-object event handlers. Useful for centralized logging or
# integration hooks.
#global_host_event_handler=global-host-handler
#global_service_event_handler=global-service-handler



##############################################################################
# PERFORMANCE DATA
##############################################################################

# Performance data can be written to files or processed by commands.
# Useful for feeding data to Graphite, InfluxDB, PNP4Nagios, etc.

#host_perfdata_command=process-host-perfdata
#service_perfdata_command=process-service-perfdata

#host_perfdata_file=var/host-perfdata.dat
#service_perfdata_file=var/service-perfdata.dat

# File mode: a = append (default), w = overwrite each interval
#host_perfdata_file_mode=a
#service_perfdata_file_mode=a

# Processing interval in seconds. After this many seconds, run the
# processing command against the perfdata file.
#host_perfdata_file_processing_interval=30
#service_perfdata_file_processing_interval=30

#host_perfdata_file_processing_command=process-host-perfdata-file
#service_perfdata_file_processing_command=process-service-perfdata-file

# Templates for perfdata file output. Supports all standard macros.
#host_perfdata_file_template=[HOSTPERFDATA]\t$TIMET$\t$HOSTNAME$\t$HOSTEXECUTIONTIME$\t$HOSTOUTPUT$\t$HOSTPERFDATA$
#service_perfdata_file_template=[SERVICEPERFDATA]\t$TIMET$\t$HOSTNAME$\t$SERVICEDESC$\t$SERVICEEXECUTIONTIME$\t$SERVICELATENCY$\t$SERVICEOUTPUT$\t$SERVICEPERFDATA$



##############################################################################
# MISCELLANEOUS
##############################################################################

# Date format for log output and display.
#   us = MM-DD-YYYY HH:MM:SS
#   euro = DD-MM-YYYY HH:MM:SS
#   iso8601 = YYYY-MM-DD HH:MM:SS
#   strict-iso8601 = YYYY-MM-DDTHH:MM:SS
#date_format=us

# Characters that are not allowed in object names or macro output.
# Helps prevent injection attacks in notification commands.
#illegal_object_name_chars=`~!$%^&*|'"<>?,()=
#illegal_macro_output_chars=`~$&|'"<>

# Admin contact info. Exposed as $ADMINEMAIL$ and $ADMINPAGER$ macros.
#admin_email=admin@example.com
#admin_pager=admin-pager@example.com

# Cached check horizons. If a host/service was checked within this
# many seconds, reuse the cached result instead of running a new check.
# Mainly affects on-demand host checks triggered by service failures.
#cached_host_check_horizon=15
#cached_service_check_horizon=15

# Time change detection. If the system clock jumps by more than this
# many seconds, Gogios adjusts the event queue to compensate.
#time_change_threshold=900
